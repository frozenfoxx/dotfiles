# Common
- defaults:
    link:
      create: true
      relink: true

- clean: ['~']

- create:
    ~/.ssh:
      mode: 0700
    ~/Documents/repos:

- link:
    # Git
    ~/.gitconfig: git/.gitconfig

    # Shell
    ~/.profile: shell/.profile

    # Tmux
    ~/.tmux.conf: tmux/.tmux.conf

    # Vim
    ~/.vimrc: vim/.vimrc

    # Zsh
    ~/.zshrc: zsh/.zshrc
    ~/.oh-my-zsh/custom/:
      glob: true
      path: zsh/custom/*.zsh
    #~/.oh-my-zsh/custom/plugins/:
    #  glob: true
    #  path: zsh/custom/plugins/*
  # globs dont work with dotbot when there's only 1 folder
    #~/.oh-my-zsh/custom/themes/powerlevel10k:
    #  glob: true
    #  path: zsh/custom/themes/powerlevel10k

- shell:
  - 
    description: Installing submodules...
    command: git submodule update --init --recursive

  -
    description: Install oh-my-zsh
    command: scripts/install_omz.sh
    stdout: true
    stdin: true

  -
    description: Install PyEnv
    command: scripts/install_pyenv.sh
    stdout: true
    stdin: true

- clean:
    - ~/.oh-my-zsh/custom
    - ~/.oh-my-zsh/custom/plugins/
    - ~/.oh-my-zsh/custom/themes/

# Linux
- defaults:
    link:
      if: '[ "$(uname -s)" = "Linux" ]'
    shell:
      if: '[ "$(uname -s)" = "Linux" ]'

- link:
    ~/.config/k9s:
      path: k8s/k9s.yaml
      force: true

- shell:
  -
    description: Install packages (Linux)
    command: scripts/install_packages_linux.sh

# macOS
- defaults:
    link:
      if: '[ "$(uname -s)" = "Darwin" ]'
    shell:
      if: '[ "$(uname -s)" = "Darwin" ]'

- link:
    ~/Library/KeyBindings/DefaultKeyBinding.dict:
      path: mac/DefaultKeyBindings.dict
      create: true
      force: true
    ~/Library/Application Support/k9s/config.yml:
      path: k8s/k9s.yaml
      force: true

- shell:
  -
    description: Install Homebrew (macOS)
    command: scripts/install_homebrew.sh
    stdout: true
    stdin: true

  -
    description: Stop .DS_Store files on network drives
    command: |
      if [ "$(uname -s)" = "Darwin" ]; then
        defaults write com.apple.desktopservices DSDontWriteNetworkStores true
      fi
    stdout: true
    stdin: true
